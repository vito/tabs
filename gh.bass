(provide [cli opts->flags]
  (use (*dir*/wget))

  (def gh-tgz
    (wget:wget
      "https://github.com/cli/cli/releases/download/v2.5.1/gh_2.5.1_linux_amd64.tar.gz"
      ./gh.tgz))

  (defn append-flag [fs k v]
    (let [flag (str "--" k)]
      (if (boolean? v)
        (conj fs flag)
        (conj fs flag v))))

  (defn opts->flags [opts]
    (reduce-kv append-flag [] opts))

  (def cli
    (from (linux/alpine)
      ($ tar -vzxf $gh-tgz -C /usr/local --strip-components=1))))
