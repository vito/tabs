(provide [wget]
  (use (*dir*/nix))

  (def image
    {:file (nix:result (cd *dir*/img/ ($ nix-build ./wget.nix))
                       ./image.tar)
     :platform {:os "linux"}
     :tag "latest"})

  (defn wget [url filename]
    (subpath
      (from image
        ($ wget $url -O $filename))
      filename)))

(defn main [url]
  (-> ($ cat (wget url ./index.html))
      (with-image (linux/nixos/nix))
      run))
